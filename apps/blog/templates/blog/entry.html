{% extends "blog/base.html" %}
{% load blog_tags %}
{% load pytils_dt %}
{% load i18n %}
{% load cache %}
{% block title %}{{ entry }}{% endblock %}
{% block meta %}
{% if entry.tags.count %}
<meta name="keywords" content="{% for tag in entry.tags %}{{ tag.name }}{% if not forloop.last %},{% endif %}{% endfor %}" />
{% endif %}
{% endblock %}
{% block sidebar %}
<div class="sidenote"><div class="inner rounded">
  <p>{% blocktrans with entry.publication_timestamp|humanized_date as date%}Published on {{ date }}{% endblocktrans %}</p>
  {% if entry.tags.count %}
    {% trans "Tags:" %}
    <ul class="entry-tags">
      {% for tag in entry.tags %}
        <li><a href="{% url blog:index_by_tag tag=tag.name|urlencode %}">{{ tag.name }}</a></li>
      {% endfor %}
    </ul>
  {% endif %}
  <div class="foot">
    <a href="{{ entry.get_absolute_url }}">{% trans "Permalink" %}</a> 
  </div>
</div></div>
{% endblock %}
{% block content %}<div class="post">
    <h2>{{ entry }}</h2>
    {% cache 6000 rendered_entry_text entry %}
    {% render_text entry %}
    {% endcache %}
  </div> 
{% endblock %}
{% block post_content %}
  {% with entry.threaded_comments as comments %}
    <div id="comments" >
      <div class="append-bottom span-18">
        <a href="#" id="add-comment" class="rounded">{% trans "Add comment" %}</a>
        <h4{% if not comments.count %} style="display: none;"{% endif %}>{% trans "Comments" %}</h4>
      </div>
      {% for comment in entry.threaded_comments %}
        {% include "blog/comments/include/comment.html" %}
      {% endfor %}
    </div>
    <script type="text/javascript">
      $(function() {
          new CommentWidget('{% url blog:comment_form entry_id=entry.id %}', '{% url blog:preview_comment %}');
      });
    </script>
  {% endwith %}
{% endblock %}
  