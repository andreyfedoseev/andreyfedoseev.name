{% extends "blog/base.html" %}
{% load blog_tags %}
{% load i18n %}
{% block title %}{{ blog }}{% endblock %}
{% block sidebar %}

{% if entry_type %}
  <div class="sidenote"><div class="inner rounded">
    {% blocktrans %}Show only {{ entry_type }}{% endblocktrans %}
    <div class="foot">
      <a href="{% url blog:index %}">{% trans "Show all entries" %}</a>
    </div>
  </div></div>
{% endif %}

{% if year %}
  <div class="sidenote"><div class="inner rounded">
    {% if month %}
      {% blocktrans with month_title|lower as month %}Show entries for {{ month }} {{ year }}{% endblocktrans %}
    {% else %}
      {% blocktrans %}Show entries for {{ year }}{% endblocktrans %}
    {% endif %} 
    <div class="foot">
      <a href="{% url blog:index %}">{% trans "Show all entries" %}</a>
    </div>
  </div></div>
{% endif %}

{% if tag %}
  <div class="sidenote"><div class="inner rounded">
    {% blocktrans %}Show only entries with tag "{{ tag }}"{% endblocktrans %}
    <div class="foot">
      <a href="{% url blog:index %}">{% trans "Show all entries" %}</a>
    </div>
  </div></div>
{% endif %}

{% endblock %}

{% block content %}
  {% if entries %}
  <div class="list">
    {% for entry in entries %}
    <div class="post hide append-bottom" id="p{{ entry.id }}"> 
      <h2><a href="{{ entry.get_absolute_url }}">{{ entry }}</a></h2>
      {% render_text entry short %}
      <div class="prepend-top clear">
      <div class="small quiet comments-count">
        {% with entry.comments.count as count %}
          {% if count %}
            <a href="{{ entry.get_absolute_url }}#comments">{% blocktrans count count as count %}{{ count }} comment{% plural %}{{ count }} comments{% endblocktrans %}</a>
          {% else %}
            <a href="{{ entry.get_absolute_url }}#add-comment">{% trans "No comments" %}</a>
          {% endif %}  
        {% endwith %}
      </div>
      <div class="small quiet">{% blocktrans with entry.publication_timestamp|humanized_date as date%}Published on {{ date }}{% endblocktrans %}</div>
      </div>
    </div>
    {% endfor %}
  </div>
  <div class="grid hide clear">
    {% for entry in entries %}
      {% include "blog/grid_entry.html" %}
    {% endfor %}
  </div>
  <script type="text/javascript">$(document).ready(init_grid);</script>
  {% else %}
    <p>{% trans "No entries have been published." %}</p> 
  {% endif %}
{% endblock %}
